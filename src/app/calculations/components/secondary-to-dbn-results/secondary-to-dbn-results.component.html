<ng-container *ngIf="calculation">
  <div class="title">
    <h2>Sequence & secondary structure topology derived from file {{ calculation.filename }}</h2>
  </div>

  <div>
    <app-reanalyze-panel [(ngModel)]="reanalyzePanelExpanded">
      <app-secondary-to-dbn-params-form [params]="calculation.results[0].params" (paramChange)="onParamsChange($event)">
      </app-secondary-to-dbn-params-form>
      <mat-divider></mat-divider>
      <app-submit-button [callback]="reanalyzeCallback" (buttonSubmit)="onSubmit($event)"></app-submit-button>
    </app-reanalyze-panel>
  </div>

  <div class="results">
    <div class="top-btns">
      <button mat-stroked-button (click)="selectAll()">{{ allSelected() ? 'Unselect' : 'Select' }} all data</button>
      <button mat-stroked-button>Download selected</button>
    </div>
    <div>
      <div class="result" *ngFor="let result of calculation.results; let i = index">
        <div class="data-panel">
          <div><button mat-stroked-button (click)="selectOne(i)">{{ isSelected(i) ? 'Unselect' : 'Select' }} this</button></div>
          <p>{{ getDescription(result.params) }}</p>
          <app-secondary-output
            [(ngModel)]="selected[i]"
            [output]="result.output">
          </app-secondary-output>
        </div>
        <div class="image-panel">
          <app-secondary-image
            [(ngModel)]="selected[i].fields.imageInformation"
            [imageInformation]="result.output.imageInformation">
          </app-secondary-image>
        </div>
      </div>
    </div>
  </div>
</ng-container>
